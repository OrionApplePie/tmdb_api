# Набор скриптов для поиска фильмов из базы The Movie Database (TMDB)

База данных фильмов [TMDB](https://www.themoviedb.org/) создается сообществом с 2008 года. Содержит в своей базе около 707 000 фильмов, а также огромное количество ТВ программ и сериалов.

Данный набор скриптов предназначен для скачивания данных о фильмах с TMDB и сохранения их в локальной базе в файле формата [JSON](https://developer.mozilla.org/ru/docs/Learn/JavaScript/Objects/JSON). Реализован поиск фильма по названию, а также поиск фильмов похожих на заданный.

Используется официальное [API](https://developers.themoviedb.org/3/getting-started/introduction) сайта.

## Требования

Должно быть установлены следующее ПО:

- [Python 3.x](https://www.python.org/)
- [Git](https://git-scm.com/download)

Опционально: для Windows удобно использовать:

- [GitHub Desktop](https://desktop.github.com/) &mdash; gui для git.
- [Cmdr](https://cmder.net/) &mdash; удобная замена стандартной командной строке Windows.

## Как установить

Скопируйте репозиторий. В терминале выполните команду:

```shell
git clone https://github.com/OrionApplePie/tmdb_api.git
```

После чего репозиторий скачается и будет доступен локально.

Далее перейдите в папку с репозиторием, и используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:

```shell
pip install -r requirements.txt
```

## Получение секретного API ключа

Секретный ключ API Key необходим для работы скриптов. Для его получения:

- Зарегистрируйтесь на [сайте](https://www.themoviedb.org/signup).
- Получите секретный ключ для работы с API следуя [инструкциям](https://www.themoviedb.org/settings/api).

## Файл hello_api_TMDB.py 

Тестирование секретного API Key, запрашивает его и отправляет запрос на получение информации о фильме с `id=215` и выводит его бюджет. Если ключ не работает, то выводит сообщение: "Invalid api key".

### Использование

В терминале введите команду:
```shell
python hello_api_TMDB.py
```

Скрипт запросит секретный ключ, необходимо его ввести (__копировать из буфера нельзя!__):
```shell
Enter your api key v3:секретный_ключ
4000000
```

Если в ответ напечатается сообщение `4000000`, то ключ работает.

## Файл make_own_db.py

Создание локальной базы фильмов под именем `MyFilmDB.json` в формате JSON.

Скрипт запрашивает секретный ключ и загружает информацию о фильмах с `id` от `0` по `999`. Если фильм с таким `id` найден, то данные фильма сохраняются, если нет &ndash; то скрипт переходит к следующему `id`. Т.о. по итогу загрузки фильмов в локальной базе может оказаться меньше чем 999.

### Использование

В терминале введите команду:

```shell
python make_own_db.py
```

Скрипт запросит секретный ключ, необходимо его ввести, затем пойдет загрузка, которая может занять некоторое время (15-20 мин.). Процент готовности выводится в консоль:

```shell
Enter your api key v3:секретный_ключ
please, wait, this operation may take smth like 15-20 minutes
0.0 percent complete
1.0 percent complete
2.0 percent complete
...
100.0 percent complete
```

После успешной загрузки в корне проекта появится файл `MyFilmDB.json`.

## Файл search_in_db.py

Поиск по локальной базе. Запрашивает имя базы, и название фильма для поиска.
Выводит все фильмы в названии которых встречается введенное название. Если ни одного фильма не найдено, то выводит сообщение "File not found, sorry...".

### Использование

В терминале введите команду:
```shell
python search_in_db.py
```

После чего скрипт запросит имя локальной базы и название фильма для поиска:

```shell
Enter path to DataBase:MyFilmDB.json
Enter film to search for:Ariel
```

Если фильмы содержащие искомое название найдены, то будут выведены их названия

```shell
Ariel
```

## Файл find_similar.py

Поиск рекомендаций по заданному фильму.
Запрашивает фильм, ищет и выводит 9 похожих фильмов следующим образом.

Для каждого фильма в локальной коллекции делается сравнение с заданным фильмом по набору параметров и составляется его рейтинг.
При совпадении параметра к рейтингу фильма прибавляется заранее определенный вес этого параметра. За принадлежность к одной коллекции дается 1000, за такой же язык фильма &ndash; 300, за совпадение бюджета &ndash; 100 и за совпадение жанров &ndash; 500. Далее выводятся только 9 фильмов начиная с фильма с наибольшим рейтингом и далее по убыванию.

### Использование

В терминале введите команду:
```shell
python find_similar.py
```

После чего необходимо ввести имя локальной базы и название фильма, чтобы найти похожие на него:
```shell
Enter path to DataBase:MyFilmDB.json
Enter film to search for:Ariel
```

Скрипт выведет похожие фильмы:
```shell
Four Rooms
Hable con ella
Kunstgriff
Las Hurdes
Megacities
My Life Without Me
Sonntag im August
The Dark
Varjoja paratiisissa
```

## Файл own_db_helpers.py

Содержит вспомогательную функцию для загрузки данных о фильмах из локального файла JSON.

## Файл tmdb_helpers.py

Содержит вспомогательные функции для скачивания информации из TMDB и проверки секретного ключа.

## Лицензия

Этот программный продукт является общественным достоянием &ndash; [LICENSE](LICENSE).